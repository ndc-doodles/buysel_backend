{% extends "base.html" %} {% load cloudinary %} {% load static %}
{% block content %}




 <section class="bg-gray-50 md:h-[75vh] flex items-center mt-[4rem] px-10 md:px-20 pt-20">
    <div class="max-w-6xl w-full flex flex-col md:flex-row items-center gap-10">

      <div class="md:w-1/2 text-left max-md:mt-[3rem]">
        <h1 class="text-4xl md:text-6xl font-bold leading-tight">
          Start Your <br />
          Commission-<span class="text-gray-400">Free</span> <br />
          Journey Today!
        </h1>
        <p class="mt-6 text-gray-600 text-lg">
          Whether it's a property or scrap,
          <span class="text-[#8bc83f] font-medium">Buysel.in</span> connects
          you directly with the right people.
        </p>
        <!-- No href here -->
        <button onclick="scrollToSection(event)"
          class="mt-6 bg-lime-500 hover:bg-lime-600 text-white font-semibold py-2 px-6 rounded-lg transition">
          Explore
        </button>

      </div>

      <!-- <div class="image-section" onclick="sendMessageToWhatsApp('property', 'place')">
        <a href="https://wa.me/9061827363" style="height: 100%" target="_blank" aria-label="WhatsApp Chat 1">
          <img class="image-box" id="box1" src="./static/img/9p.jpg" alt />
        </a>
        <a href="https://wa.me/9061827363" style="height: 100%" target="_blank" aria-label="WhatsApp Chat 1">
          <img class="image-box" id="box2" src="./static/img/10p.jpg" alt />
        </a>
        <a href="https://wa.me/9061827363" style="height: 100%" target="_blank" aria-label="WhatsApp Chat 1">
          <img class="image-box" id="box3" src="./static/img/11p.jpg" alt />
        </a>
        <a href="https://wa.me/9061827363" style="height: 100%" target="_blank" aria-label="WhatsApp Chat 1">
          <img class="image-box" id="box4" src="./static/img/9p.jpg" alt />
        </a>
      </div> -->

      <div class="w-full h-[37vh] md:h-[75vh] flex xl:mr-[-14rem]" id="slidingmain">
        <a href="https://wa.me/9061827363" class="w-[50%] transition-all duration-1000" target="_blank" id="sliding1"
          aria-label="WhatsApp Chat 1">
          <img class="h-full w-full object-cover object-center shrink-0" src="./static/img/9p.jpg" alt />
        </a>
        <a href="https://wa.me/9061827363" class="w-[30%] ml-2 transition-all duration-1000" target="_blank" id="sliding2"
          aria-label="WhatsApp Chat 1">
          <img class="h-full w-full object-cover object-center shrink-0" src="./static/img/10p.jpg" alt />
        </a>
        <a href="https://wa.me/9061827363" class="w-[20%] ml-2 transition-all duration-1000" target="_blank" id="sliding3"
          aria-label="WhatsApp Chat 1">
          <img class="h-full w-full object-cover object-center shrink-0" src="./static/img/11p.jpg" alt />
        </a>
        <a href="https://wa.me/9061827363" class="w-0 ml-2 transition-all duration-1000" target="_blank" id="sliding4"
          aria-label="WhatsApp Chat 1">
          <img class="h-full w-full object-cover object-center shrink-0" src="./static/img/9p.jpg" alt />
        </a>
      </div>

    </div>
  </section>

<script>
  

document.addEventListener("DOMContentLoaded", handleHomeAnimation);


let eachSlide = 1

function handleHomeAnimation() {
  const mainDiv = document.getElementById('slidingmain')
  
  
  setInterval(() => {

    

    const slidingOne = document.getElementById(`sliding${eachSlide}`)
    const slidingTwo = document.getElementById(`sliding${eachSlide+1}`)
    const slidingThree = document.getElementById(`sliding${eachSlide+2}`)
    const slidingFour = document.getElementById(`sliding${eachSlide+3}`)

    slidingOne.style.width = "0%"
    slidingOne.style.marginLeft = '0px'
    slidingTwo.style.width = "50%"
    slidingThree.style.width = "30%"
    slidingFour.style.width = "20%"


          console.log(eachSlide%3,'mod');


    const images = [
      "./static/img/9p.jpg",
      "./static/img/10p.jpg",
      "./static/img/11p.jpg",
        ];
    
    const imgElement = createElement(images[eachSlide%3],eachSlide+4)

  
    
    mainDiv.appendChild(imgElement)

    eachSlide = eachSlide+1

  }, 2000);


}


function createElement(image,id){

  // Create the <a> element
  const link = document.createElement("a");
  link.href = "https://wa.me/9061827363";
  link.className = "w-0 ml-2 transition-all duration-1000";
  link.target = "_blank";
  link.id = `sliding${id}`;
  link.setAttribute("aria-label", "WhatsApp Chat 1");

  // Create the <img> element
  const img = document.createElement("img");
  img.src = image;
  img.alt = "";
  img.className = "h-full w-full object-cover object-center shrink-0";

  // Append image inside link
  link.appendChild(img);
  console.log(link,'mainn');
  
  return link
}
</script>


<div id="properties"></div>







<section class="xl:px-24 py-10 mt-20 md:px-16 px-10 max-md:px-6">
  <h2 class="text-4xl font-bold text-gray-800 uppercase text-center mb-2">Properties</h2>
  <p class="text-center text-gray-500 text-sm sm:text-base mb-8">
    Explore our latest listings for sale, rent and lease across your favorite locations.
  </p>

  <!-- Filter Tabs -->
  <div class="grid grid-cols-3 sm:flex sm:flex-nowrap justify-center items-center gap-3 mb-10 mt-10">
    <button onclick="filterCards('all', this)" class="filter-btn min-w-[96px] sm:min-w-[110px] px-4 py-2 bg-[#8bc83f] text-white rounded-lg text-sm sm:text-base">All</button>
    <button onclick="filterCards('Sale', this)" class="filter-btn min-w-[96px] sm:min-w-[110px] px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-[#8bc83f] hover:text-white">Sale</button>
    <button onclick="filterCards('Rent', this)" class="filter-btn min-w-[96px] sm:min-w-[110px] px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-[#8bc83f] hover:text-white">Rent</button>
    <button onclick="filterCards('Lease', this)" class="filter-btn min-w-[96px] sm:min-w-[110px] px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-[#8bc83f] hover:text-white">Lease</button>

    <!-- Sidebar Filter -->
    <button onclick="toggleSidebar()" class="min-w-[96px] sm:min-w-[110px] px-4 py-2 border border-[#8bc83f] text-[#8bc83f] rounded-lg hover:bg-[#f3fef1] flex items-center gap-1">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24">
        <path fill="none" stroke="#8bc83f" stroke-linecap="round" stroke-miterlimit="10" stroke-width="1.5"
          d="M21.25 12H8.895m-4.361 0H2.75m18.5 6.607h-5.748m-4.361 0H2.75m18.5-13.214h-3.105m-4.361 0H2.75m13.214 2.18a2.18 2.18 0 1 0 0-4.36a2.18 2.18 0 0 0 0 4.36Zm-9.25 6.607a2.18 2.18 0 1 0 0-4.36a2.18 2.18 0 0 0 0 4.36Zm6.607 6.608a2.18 2.18 0 1 0 0-4.361a2.18 2.18 0 0 0 0 4.36Z" />
      </svg>
      <span>Filter</span>
    </button>
  </div>

  <p id="no-results-msg" class="text-center text-red-600 text-lg font-semibold hidden mb-6">No properties found.</p>

  <!-- Nearest Property Section -->
  <div class="w-full my-6">
    <button id="findNearestBtn" class="px-4 py-2 bg-[#8bc83f] text-white rounded-lg shadow hover:bg-green-600 transition">
      üìç Find Properties by Distance
    </button>
  </div>

  <div id="nearestPropertyResult" class="my-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 w-full"></div>

  <div id="allProperties" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 w-full">
    {% for property in properties %}
      <div class="property-card bg-white rounded-[18px] shadow-md overflow-hidden relative hover:shadow-lg transition duration-300" data-type="{{ property.purpose.name }}">
        <div class="relative p-2">
          {% if property.images.all %}
            <img src="{{ property.images.first.image.url }}" alt="Property Image" class="w-full h-56 object-cover rounded-[18px] property-image"
              data-images='[{% for img in property.images.all %}"{{ img.image.url }}"{% if not forloop.last %},{% endif %}{% endfor %}]'/>
          {% else %}
            <img src="{% static 'images/demo.png' %}" alt="Property Image" class="w-full h-56 object-cover rounded-[18px] property-image" data-images='["{% static "images/demo.png" %}"]'/>
          {% endif %}
          <div class="absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2 z-10 dots-container">
            {% for img in property.images.all %}
              <span class="dot w-1.5 h-1.5 bg-white rounded-full opacity-70 cursor-pointer"></span>
            {% endfor %}
          </div>
        </div>
        <button id="openShareModal" class="absolute top-3 right-3 group">
  <span class="bg-white p-2 rounded-full inline-block shadow">
    
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
              <path fill="#000" fill-rule="evenodd"
                d="M16.5 2.25a3.25 3.25 0 0 0-3.2 3.824L8.57 9.386l-.068.053a3.25 3.25 0 1 0 0 5.121l.068.054l4.73 3.312q-.05.28-.05.574a3.25 3.25 0 1 0 .667-1.973L9.438 13.39c.2-.422.312-.893.312-1.391s-.112-.97-.312-1.391l4.48-3.136A3.25 3.25 0 1 0 16.5 2.25M14.75 5.5a1.75 1.75 0 1 1 3.5 0a1.75 1.75 0 0 1-3.5 0M6.5 10.25a1.75 1.75 0 1 0 0 3.5a1.75 1.75 0 0 0 0-3.5m10 6.5a1.75 1.75 0 1 0 0 3.5a1.75 1.75 0 0 0 0-3.5"
                clip-rule="evenodd" />
            </svg>
  </span>
</button> 
        <span class="absolute top-3 left-3 bg-[red] text-white text-[13px] font-semibold px-3 py-1 rounded-lg shadow-sm">{{ property.purpose.name }}</span>
        <div class="p-4">
          <p class="text-[#8b8b8b] font-semibold text-[13px] mb-2">{{property.sq_ft}}</p>
          <h3 class="text-[19px] font-semibold text-gray-800">{{ property.label }}</h3>
          <p class="text-[12px] text-gray-400 whitespace-nowrap overflow-hidden text-ellipsis mb-1">{{property.description}}</p>
          <a href="{% url 'property_detail' property.id %}" class="inline-block text-[12px] text-[#0088FF] underline">View Details</a>
          <hr class="my-2 border-gray-200" />
          {% if property.perprice %}
            <p class="text-[22px] font-semibold text-black">{{ property.perprice }}</p>
          {% endif %}
          <p class="text-[#8b8b8b] text-[13px]">Total {{property.price}}</p>
          <hr class="my-2 border-gray-200" />
          <div class="flex justify-between items-center">
            <p class="text-[15px] text-black flex items-center gap-1">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
        <g fill="none" stroke="#8bc83f" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5">
          <path
            d="M12.56 20.82a.96.96 0 0 1-1.12 0C6.611 17.378 1.486 10.298 6.667 5.182A7.6 7.6 0 0 1 12 3c2 0 3.919.785 5.333 2.181c5.181 5.116.056 12.196-4.773 15.64" />
          <path d="M12 12a2 2 0 1 0 0-4a2 2 0 0 0 0 4" />
        </g>
      </svg>              {{property.land_area}}
            </p>
            <a href="{{property.location}}" class="text-[#0088FF] text-[13px] underline">Directions</a>
          </div>
          <div class="flex items-center justify-between mt-3 space-x-2 w-64">
    <a href="tel:1234567890"
      class="w-1/2 flex items-center justify-center text-sm bg-[#8bc83f] text-white px-2 py-2 rounded-[12px] transition space-x-1"
      onclick="event.stopPropagation()">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
        <path fill="#fff"
          d="M19.95 21q-3.125 0-6.175-1.362t-5.55-3.863t-3.862-5.55T3 4.05q0-.45.3-.75t.75-.3H8.1q.35 0 .625.238t.325.562l.65 3.5q.05.4-.025.675T9.4 8.45L6.975 10.9q.5.925 1.187 1.787t1.513 1.663q.775.775 1.625 1.438T13.1 17l2.35-2.35q.225-.225.588-.337t.712-.063l3.45.7q.35.1.575.363T21 15.9v4.05q0 .45-.3.75t-.75.3" />
      </svg>
      <span class="text-base">Call</span>
    </a>

    <a href="https://wa.me/1234567890" target="_blank"
      class="w-1/2 flex items-center justify-center text-sm border border-black px-2 py-2 rounded-[12px] transition space-x-1 group bg-white hover:bg-[#8bc83f]"
      onclick="event.stopPropagation()">
      <img src="{% static '/img/whatsapp.png'%}">
      <span class="text-black group-hover:text-white">WhatsApp</span>
    </a>
  </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <div class="flex justify-center mt-10">
    <a href="{% url 'properties' %}">
      <button class="border border-[#8bc83f] px-4 py-2 text-[#8bc83f] hover:text-white hover:bg-[#8bc83f] rounded-md">Explore More</button>
    </a>
  </div>
</section>

<!-- Sidebar Filter -->
<div id="sidebarFilter" class="fixed top-1/2 right-0 w-[350px] h-[600px] bg-white shadow-lg z-50 transform -translate-y-1/2 translate-x-full transition-transform duration-300 ease-in-out overflow-y-auto">
  <div class="p-6">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-semibold text-gray-800">Filter Properties</h3>
      <button onclick="toggleSidebar()" class="text-gray-600 text-2xl hover:text-red-600">&times;</button>
    </div>
    <div class="space-y-4">
      <div>
        <label class="block text-sm font-semibold mb-1">Purpose</label>
        <select id="filterPurpose" class="w-full border border-gray-300 rounded-lg px-3 py-2">
          <option value="">All</option>
          {% for p in purposes %}<option value="{{p.id}}">{{p.name}}</option>{% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-sm font-semibold mb-1">Category</label>
        <select id="filterCategory" class="w-full border border-gray-300 rounded-lg px-3 py-2">
          <option value="">All</option>
          {% for c in categories %}<option value="{{ c.id }}">{{ c.name }}</option>{% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-sm font-semibold mb-1">District</label>
        <select id="filterDistrict" class="w-full border border-gray-300 rounded-lg px-3 py-2">
          <option value="">All</option>
          {% for d in districts %}<option value="{{d}}">{{d}}</option>{% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-sm font-semibold mb-1">City</label>
        <select id="filterCity" class="w-full border border-gray-300 rounded-lg px-3 py-2">
          <option value="">All</option>
          {% for c in cities %}<option value="{{c}}">{{c}}</option>{% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-sm font-semibold mb-1">Price Range</label>
        <div class="flex items-center gap-2">
          <input id="minPrice" type="number" placeholder="Min" class="w-1/2 border border-gray-300 rounded-lg px-3 py-2" />
          <input id="maxPrice" type="number" placeholder="Max" class="w-1/2 border border-gray-300 rounded-lg px-3 py-2" />
        </div>
      </div>

      <div class="pt-2">
        <button id="applyFiltersBtn" class="w-full bg-[#8bc83f] text-white rounded-lg px-4 py-2 hover:bg-green-600 transition">Apply Filters</button>
      </div>
    </div>
  </div>
</div>
<script>
document.addEventListener("DOMContentLoaded", function () {

  // --------- Image Slider ---------
  function initSlider(card) {
    const imageEl = card.querySelector(".property-image");
    const dotsContainer = card.querySelector(".dots-container");
    if (!imageEl || !imageEl.dataset.images) return;

    const images = JSON.parse(imageEl.dataset.images);
    let currentIndex = 0;

    // Build dots dynamically
    dotsContainer.innerHTML = images.map(() =>
      `<span class="dot w-1.5 h-1.5 bg-white rounded-full opacity-70 cursor-pointer"></span>`
    ).join("");

    const dots = dotsContainer.querySelectorAll(".dot");

    function changeImage(i) {
      imageEl.src = images[i];
      currentIndex = i;
      dots.forEach((d, idx) => {
        d.classList.toggle("w-2", idx === i);
        d.classList.toggle("h-2", idx === i);
        d.classList.toggle("opacity-100", idx === i);
        d.classList.toggle("opacity-70", idx !== i);
      });
    }

    dots.forEach((dot, i) => dot.addEventListener("click", () => changeImage(i)));
    changeImage(0);
  }

  // --------- Filter Cards by Tab ---------
  window.filterCards = function(type, btn) {
    const cards = document.querySelectorAll("#allProperties .property-card");
    cards.forEach(card => {
      if(type === 'all' || card.dataset.type === type) card.style.display = "block";
      else card.style.display = "none";
    });

    // Update active button
    document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("bg-[#8bc83f]", "text-white"));
    btn.classList.add("bg-[#8bc83f]", "text-white");
  }

  // --------- Build Property Card HTML (AJAX calls use this) ---------
  function buildPropertyCard(p) {
    // Normalize purpose field
    const purposeName = p.purpose_name || p.purpose || '';

    const images = p.images && p.images.length 
        ? p.images 
        : ["{% static 'images/demo.png' %}"];

    return `
    <div class="property-card bg-white rounded-[18px] shadow-md overflow-hidden relative hover:shadow-lg transition duration-300" data-type="${purposeName}">
        <div class="relative p-2">
          <img src="${images[0]}" alt="Property Image" class="property-image w-full h-56 object-cover rounded-[18px]" data-images='${JSON.stringify(images)}'/>
          <div class="absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2 z-10 dots-container"></div>
        </div>

        <!-- Share Button -->
        <button class="absolute top-3 right-3 group">
          <span class="bg-white p-2 rounded-full inline-block shadow">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
              <path fill="#000" fill-rule="evenodd"
                d="M16.5 2.25a3.25 3.25 0 0 0-3.2 3.824L8.57 9.386l-.068.053a3.25 3.25 0 1 0 0 5.121l.068.054l4.73 3.312q-.05.28-.05.574a3.25 3.25 0 1 0 .667-1.973L9.438 13.39c.2-.422.312-.893.312-1.391s-.112-.97-.312-1.391l4.48-3.136A3.25 3.25 0 1 0 16.5 2.25M14.75 5.5a1.75 1.75 0 1 1 3.5 0a1.75 1.75 0 0 1-3.5 0M6.5 10.25a1.75 1.75 0 1 0 0 3.5a1.75 1.75 0 0 0 0-3.5m10 6.5a1.75 1.75 0 1 0 0 3.5a1.75 1.75 0 0 0 0-3.5"
                clip-rule="evenodd" />
            </svg>
          </span>
        </button>

        <!-- Purpose -->
        <span class="absolute top-3 left-3 bg-[red] text-white text-[13px] font-semibold px-3 py-1 rounded-lg shadow-sm">${purposeName}</span>

        <div class="p-4">
          <p class="text-[#8b8b8b] font-semibold text-[13px] mb-2">${p.sq_ft || ''}</p>
          <h3 class="text-[19px] font-semibold text-gray-800">${p.label}</h3>
          <p class="text-[12px] text-gray-400 whitespace-nowrap overflow-hidden text-ellipsis mb-1">${p.description || p.desc || ''}</p>

          <a href="/property/${p.id}" class="inline-block text-[12px] text-[#0088FF] underline">View Details</a>

          <hr class="my-2 border-gray-200" />
          ${p.perprice ? `<p class="text-[22px] font-semibold text-black">${p.perprice}</p>` : ""}
          <p class="text-[#8b8b8b] text-[13px]">Total ${p.price || ''}</p>
          <hr class="my-2 border-gray-200" />

          <div class="flex justify-between items-center">
            <p class="text-[15px] text-black flex items-center gap-1">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <g fill="none" stroke="#8bc83f" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5">
                  <path d="M12.56 20.82a.96.96 0 0 1-1.12 0C6.611 17.378 1.486 10.298 6.667 5.182A7.6 7.6 0 0 1 12 3c2 0 3.919.785 5.333 2.181c5.181 5.116.056 12.196-4.773 15.64" />
                  <path d="M12 12a2 2 0 1 0 0-4a2 2 0 0 0 0 4" />
                </g>
              </svg>
              ${p.land_area || ''}
            </p>
            <a href="${p.location || '#'}" class="text-[#0088FF] text-[13px] underline">Directions</a>
          </div>

          <!-- Call & WhatsApp -->
          <div class="flex items-center justify-between mt-3 space-x-2 w-64">
            <a href="tel:${p.phone || '1234567890'}"
              class="w-1/2 flex items-center justify-center text-sm bg-[#8bc83f] text-white px-2 py-2 rounded-[12px] transition space-x-1"
              onclick="event.stopPropagation()">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                <path fill="#fff"
                  d="M19.95 21q-3.125 0-6.175-1.362t-5.55-3.863t-3.862-5.55T3 4.05q0-.45.3-.75t.75-.3H8.1q.35 0 .625.238t.325.562l.65 3.5q.05.4-.025.675T9.4 8.45L6.975 10.9q.5.925 1.187 1.787t1.513 1.663q.775.775 1.625 1.438T13.1 17l2.35-2.35q.225-.225.588-.337t.712-.063l3.45.7q.35.1.575.363T21 15.9v4.05q0 .45-.3.75t-.75.3" />
              </svg>
              <span class="text-base">Call</span>
            </a>

            <a href="https://wa.me/${p.phone || '1234567890'}" target="_blank"
              class="w-1/2 flex items-center justify-center text-sm border border-black px-2 py-2 rounded-[12px] transition space-x-1 group bg-white hover:bg-[#8bc83f]"
              onclick="event.stopPropagation()">
              <img src="{% static 'img/whatsapp.png' %}">
              <span class="text-black group-hover:text-white">WhatsApp</span>
            </a>
          </div>
        </div>
      </div>
    `;
  }

  // --------- Nearest Properties (AJAX) ---------
  const nearestBtn = document.getElementById("findNearestBtn");
  const resultDiv = document.getElementById("nearestPropertyResult");
  const allPropsDiv = document.getElementById("allProperties");

  nearestBtn?.addEventListener("click", () => {
    if (!navigator.geolocation) return alert("Geolocation not supported");

    navigator.geolocation.getCurrentPosition(pos => {
      fetch(`/nearest-properties/?lat=${pos.coords.latitude}&lng=${pos.coords.longitude}`)
        .then(res => res.json())
        .then(data => {
          allPropsDiv.style.display = "none";
          resultDiv.innerHTML = "";

          if (!data.length || data.error) {
            resultDiv.innerHTML = `<p class="text-red-500">No nearby properties found.</p>`;
          } else {
            data.forEach(p => resultDiv.innerHTML += buildPropertyCard(p));
            document.querySelectorAll("#nearestPropertyResult .property-card").forEach(initSlider);
          }
        })
        .catch(err => resultDiv.innerHTML = `<p class="text-red-500">Error: ${err.message}</p>`);
    });
  });

  // --------- Apply Filters (AJAX) ---------
  const applyBtn = document.getElementById("applyFiltersBtn");
  applyBtn?.addEventListener("click", () => {
    const params = new URLSearchParams({
      purpose: document.getElementById("filterPurpose").value,
      category: document.getElementById("filterCategory").value,
      district: document.getElementById("filterDistrict").value,
      city: document.getElementById("filterCity").value,
      min_price: document.getElementById("minPrice").value || "",
      max_price: document.getElementById("maxPrice").value || ""
    });

    fetch(`/filter-properties/?${params.toString()}`)
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById("allProperties");
        container.innerHTML = "";
        document.getElementById("no-results-msg").classList.add("hidden");

        if (!data.length || data.error) {
          document.getElementById("no-results-msg").classList.remove("hidden");
        } else {
          data.forEach(p => container.innerHTML += buildPropertyCard(p));
          document.querySelectorAll("#allProperties .property-card").forEach(initSlider);
          allPropsDiv.style.display = "grid";
          resultDiv.innerHTML = "";
        }
      })
      .catch(err => console.error(err));
  });

  // --------- Toggle Sidebar ---------
  window.toggleSidebar = function () {
    document.getElementById("sidebarFilter").classList.toggle("translate-x-full");
  }

  // --------- Initialize Sliders on Page Load ---------
  document.querySelectorAll("#allProperties .property-card").forEach(initSlider);

});
</script>






<section class=" py-16 px-6 lg:px-20">
  <div class="max-w-7xl mx-auto flex flex-col lg:flex-row items-center gap-12">

    <div class="w-full text-center  md:text-left">
      <h1 class="text-3xl md:text-4xl font-bold mb-4">
        LIST NOW & GET
        <br />
        <span class="text-[#a8bfa0]">NOTICED!</span>
      </h1>
      <p class="text-gray-700 mb-6">
        Share your property details with us and get listed on BuySel
        to reach active buyers and sellers faster!
      </p>
      <button onclick="openPropertyModal()"
        class="inline-flex items-center gap-2 bg-white border border-[#a8bfa0] text-[#8bc83f] font-semibold px-6 py-3 rounded-full shadow hover:bg-green-50 transition">
        Add your property
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
      </button>
    </div>

    <div class="w-full relative flex justify-center">
      <div class="relative">
        <img src="https://storage.googleapis.com/a1aa/image/ZleGScqhQ7yKeEMNfTUDy3XQmOkgSUQVzZkIFVZfkcVzUGEQB.jpg"
          alt="Background"
          class="rounded-lg shadow-md w-72 h-80 object-cover mx-auto max-md:w-56 max-md:h-64 max-sm:w-52 max-sm:h-44" />

        <img src="https://storage.googleapis.com/a1aa/image/fFr3NpP8fZqEAUuvcHsjaowep8eei8G9PHOwKZIkeko0SZQAF.jpg"
          alt="Key in door"
          class="absolute top-16 left-32 translate-x-4 translate-y-4 rounded-lg shadow-lg w-72 h-80 max-md:w-56 max-md:h-64 max-md:left-20 max-sm:w-52 max-sm:h-44 max-sm:left-4 object-cover" />
      </div>
    </div>

    <div id="propertyModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 max-md:px-[16px]">
      <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl h-[600px] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold">Add Property</h2>
          <button onclick="closePropertyModal()" class="text-gray-500 hover:text-black text-2xl">&times;</button>
        </div>

        <form class="space-y-4" method="POST" enctype="multipart/form-data">
          {% csrf_token %}
          <div>
            <label class="block text-gray-700 font-semibold mb-1">Category</label>
            <input type="text" name="categories" placeholder="e.g. House, Land, Off-Plan"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">Purpose</label>
            <input type="text" name="purposes" required placeholder="e.g. house for sale"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>

          <div>
    <label class="block text-gray-700 font-semibold mb-1">Label</label>
    <input type="text" name="label" required placeholder="e.g. sale,rent"
      class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring" />
  </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">Land Area (in units)</label>
            <input type="text" name="land_area" required placeholder="e.g. 2000"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">Sq.ft</label>
            <input type="number" name="sq_ft" required placeholder="e.g. 1200"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">Description</label>
            <textarea rows="4" name="about_the_property" required placeholder="Enter your message"
              class="w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-lime-500 focus:border-lime-500"></textarea>
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">Amenities</label>
            <input type="text" name="amenities" required placeholder="e.g. Parking, Pool, Garden"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">Upload Property Image</label>
            <input type="file" required accept="image/*" name="image"
              class="mt-1 w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-lime-500 focus:border-lime-500" />
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">Price Details</label>
            <input type="number" name="price" required placeholder="e.g. 500000"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>
          <div>
    <label class="block text-gray-700 font-semibold mb-1">Total Price</label>
    <input type="number" name="total_price" required placeholder="e.g. 750000"
      class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring" />
  </div>
          <div>
            <label class="block text-gray-700 font-semibold mb-1">Owner Name</label>
            <input type="text" name="owner" required placeholder="e.g. John Doe"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">Phone Number</label>
            <input type="tel" name="phone" required placeholder="e.g. +91 9876543210"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>

          <div>
    <label class="block text-gray-700 font-semibold mb-1">WhatsApp Number</label>
    <input type="tel" name="whatsapp" required placeholder="e.g. +91 9876543210"
      class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring" />
  </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">Location</label>
            <input type="url" name="locations" required placeholder="Paste your property location from Google Maps"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>

          <div>
    <label class="block text-gray-700 font-semibold mb-1">City</label>
    <input type="text" required name="city" placeholder="e.g. Bangalore"
      class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring" />
  </div>

  <div>
    <label class="block text-gray-700 font-semibold mb-1">District</label>
    <input type="text" name="District" required placeholder="e.g. Bangalore Urban"
      class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring" />
  </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">PIN Code</label>
            <input type="text" name="pin_code" required placeholder="e.g. 560001"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1">Landmark</label>
            <input type="text" name="land_mark" required placeholder="e.g. Near City Mall"
              class="w-full border border-gray-300 rounded px-4 py-2 focus:outline-none focus:ring" />
          </div>
          <div>
    <label class="block text-gray-700 font-semibold mb-1">Duration</label>
    <input type="text" name="duration" required placeholder="e.g. 12 Months Lease, 6 Months Rent"
      class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring" />
  </div>


          <div class="flex justify-end">
            <button type="submit" class="bg-black text-white px-4 py-2 rounded hover:bg-gray-800">Submit</button>
          </div>
        </form>
      
      
      
      </div>
    </div>

  </div>
</section>




<div class="w-full bg-[#8bc83f]/40 h-[500px] flex flex-col lg:flex-row items-center mt-20 ">
  <div class="w-full lg:w-1/2 xl:px-28 py-8  text-section text-center lg:text-left ">
    <h2 class="text-2xl  md:text-3xl font-bold text-gray-800 mb-4">
      JOIN AS AN<br><span class="text-[#a8bfa0]">AGENT</span>
    </h2>
    <p class="text-gray-700 mb-6">
      Register with BuySel to list properties under your name and connect with more buyers, sellers and potential
      clients.
    </p>


    <button onclick="openAgentModal()"
      class="inline-flex items-center gap-2 bg-black text-gray-200 font-semibold px-6 py-2 rounded hover:bg-gray-900 transition max-md:mt-[2rem]">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
        <path fill="currentColor"
          d="M15 14c-2.67 0-8 1.33-8 4v2h16v-2c0-2.67-5.33-4-8-4m-9-4V7H4v3H1v2h3v3h2v-3h3v-2m6 2a4 4 0 0 0 4-4a4 4 0 0 0-4-4a4 4 0 0 0-4 4a4 4 0 0 0 4 4" />
      </svg>
      Register as an agent
    </button>


    <div id="agentModal"
      class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center max-md:px-[16px]">
      <div class="bg-white rounded-xl p-6 w-full max-w-md relative">

        <button onclick="closeAgentModal()"
          class="absolute top-4 right-4 text-gray-500 hover:text-black text-2xl">&times;</button>

        <h2 class="text-xl font-bold mb-4 text-center">Register as an Agent</h2>
        <form id="agentForm" class="space-y-6" method="POST" enctype="multipart/form-data">
          {% csrf_token %}
          <input type="text" name="name" placeholder="Name" required class="w-full px-4 py-2 border rounded" />
          <input type="email" name="email" placeholder="Email" required class="w-full px-4 py-2 border rounded" />
          <input type="text" name="address" placeholder="Address" required class="w-full px-4 py-2 border rounded" />
          <input type="tel" name="phone_number" placeholder="Phone Number" required class="w-full px-4 py-2 border rounded" />

          <select name="Dealings" required class="w-full px-4 py-2 border rounded">
            <option value="">Specialised In</option>
            <option value="sale">Sale</option>
            <option value="rent">Rent</option>
            <option value="lease">Lease</option>
            <option value="lease">All</option>
          </select>

          <input type="file" name="image" accept="image/*" required class="w-full px-4 py-2 border rounded" />

          <button type="submit" class="w-full bg-black text-white py-2 rounded hover:bg-gray-800">Submit</button>
        </form>
      </div>
    </div>

  </div>

  <div class="w-full lg:w-1/2 h-64 lg:h-full relative img-container">
    <img src="{% static 'img/9p.jpg' %}" alt="agent" class="h-full w-full object-cover" />
    <div class="img-overlay"></div>
  </div>
</div>





<section class="bg-white py-8 mt-10">
  <h2 class="text-2xl md:text-4xl font-bold text-center mb-6 text-gray-800 uppercase">Our Trusted Agents</h2>

  <div class="overflow-hidden max-w-5xl mx-auto mt-20">
    <div class="flex gap-2 animate-marquee max-md:gap-10">
        {% for premium in premium %}
      <div class="flex-shrink-0 w-1/4 text-center">
        <img src="{{premium.image.url}}" alt="{{premium.name}}"
          class="w-24 h-24 rounded-full object-cover mx-auto mb-2 border-2 border-gray-300 shadow-sm">
        <h3 class="text-sm font-semibold text-gray-800">{{premium.name}}</h3>
        <p class="text-xs text-gray-500">{{premium.city}}</p>
      </div>
    {% endfor %}

    </div>
  </div>
  <div class="relative sm:hidden">
    <button onclick="scrollAgents('left')"
      class="absolute left-0 top-1/2 -translate-y-1/2 bg-white shadow-md rounded-full p-2 z-10">
      &#8592;
    </button>

    <button onclick="scrollAgents('right')"
      class="absolute right-0 top-1/2 -translate-y-1/2 bg-white shadow-md rounded-full p-2 z-10">
      &#8594;
    </button>
  </div>

</section>





<div class="w-full  px-4 sm:px-10 lg:px-20 py-10 mt-10">
  <div class="text-center mb-10">
    <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2 uppercase">About
      Us</h2>
    <p class="text-gray-500 text-sm sm:text-base">Your trusted partner in
      finding, buying, selling and leasing properties.</p>
  </div>

  <div class="w-full flex flex-col lg:flex-row justify-between items-center relative  lg:gap-10">

    <div class="w-full lg:w-1/2 mb-10 lg:mb-0 px-2 sm:px-4 lg:mr-10">
      <p class="text-gray-700 text-base leading-relaxed mb-6">
        Buysel.in offers an innovative approach to property transactions,
        ensuring a seamless experience for both buyers and sellers. Our
        platform also offers a dedicated section for scrap and e-waste
        transactions, making it easy for individuals and businesses to
        dispose of their unwanted items responsibly.
      </p>
      <p class="text-gray-700 text-base leading-relaxed">
        We focus on transparency, efficiency and building a community where
        individuals can connect directly for their needs. Join Buysel.in
        today and experience the future of property and scrap transactions.
      </p>
    </div>

    <div class="w-full lg:w-1/2 relative flex justify-center lg:justify-end">
      <img src="./static/images/about1.png" alt="Real Estate About"
        class="w-full max-w-[500px] h-[300px] sm:h-[350px] md:h-[400px] object-cover shadow-lg rounded-md">

      <div
        class="bg-black text-white p-4 sm:p-6 max-w-xs sm:max-w-sm md:max-w-md absolute -left-4 sm:-left-12 top-1/2 -translate-y-1/2 shadow-xl hidden lg:block rounded-md">
        <h2 class="text-lg sm:text-xl font-semibold mb-3 uppercase">Your
          Property, Our Priority</h2>
        <p class="text-sm text-gray-300 leading-relaxed mb-4">
          Buysel.in is your one-stop solution for commission-free property
          and scrap transactions. Our mission is to empower users by
          eliminating middlemen and creating a transparent, efficient
          platform for buying, selling, renting, and leasing.
        </p>
        <a href="about.html" class="text-sm underline">Read More</a>
      </div>
    </div>
  </div>
</div>

<div class="w-full bg-gray-50 px-6 py-16 lg:px-20">
  <div class="flex flex-col lg:flex-row gap-10">

    <div class="lg:w-1/3">
      <h2 class="text-3xl font-bold uppercase text-gray-800 mb-4">Frequently
        Asked<br>Questions</h2>
      <p class="text-gray-600 text-sm">Find answers to the most common
        questions about our platform and services.</p>
    </div>

    <div class="lg:w-2/3 space-y-4">

      <div class="border border-gray-300 rounded-lg overflow-hidden">
        <button
          class="w-full text-left px-6 py-4 bg-white font-medium text-gray-800 flex justify-between items-center faq-toggle">
          What is Buysel.in?
          <svg class="w-5 h-5 transform transition-transform duration-300" fill="none" stroke="currentColor"
            viewBox="0 0 24 24">
            <path d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div class="hidden px-6 py-4 text-sm text-gray-600 bg-gray-100">
          Buysel.in connects buyers and sellers directly for property and
          scrap deals, ensuring a zero-commission, hassle-free experience.
        </div>
      </div>

      <div class="border border-gray-300 rounded-lg overflow-hidden">
        <button
          class="w-full text-left px-6 py-4 bg-white font-medium text-gray-800 flex justify-between items-center faq-toggle">
          How does Buysel.in work?
          <svg class="w-5 h-5 transform transition-transform duration-300" fill="none" stroke="currentColor"
            viewBox="0 0 24 24">
            <path d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div class="hidden px-6 py-4 text-sm text-gray-600 bg-gray-100">
          Buysel.in enables users to list properties or scrap, connect with
          verified buyers or sellers, and enjoy a transparent,
          cost-effective experience.
        </div>
      </div>

      <div class="border border-gray-300 rounded-lg overflow-hidden">
        <button
          class="w-full text-left px-6 py-4 bg-white font-medium text-gray-800 flex justify-between items-center faq-toggle">
          What services does Buysel.in offer?
          <svg class="w-5 h-5 transform transition-transform duration-300" fill="none" stroke="currentColor"
            viewBox="0 0 24 24">
            <path d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div class="hidden px-6 py-4 text-sm text-gray-600 bg-gray-100">
          Buysel.in connects buyers and sellers directly on a
          commission-free platform, ensuring secure, verified listings. It
          offers a transparent and hassle-free experience across real estate
          and e-waste transactions.
        </div>
      </div>

      <div class="border border-gray-300 rounded-lg overflow-hidden">
        <button
          class="w-full text-left px-6 py-4 bg-white font-medium text-gray-800 flex justify-between items-center faq-toggle">
          Is Buysel.in free to use?
          <svg class="w-5 h-5 transform transition-transform duration-300" fill="none" stroke="currentColor"
            viewBox="0 0 24 24">
            <path d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div class="hidden px-6 py-4 text-sm text-gray-600 bg-gray-100">
          Users can explore listings for free, while a small fee applies for
          posting properties or scrap materials for sale, rent or lease,
          ensuring a high-quality, reliable marketplace for all.
        </div>
      </div>

    </div>
  </div>
</div>





<button id="floatMessageBtn" onclick="openMessageModal()"
  class="hidden fixed bottom-4 right-4 bg-[#8bc83f] text-white p-3 rounded-full shadow-lg z-40">

  <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24">
    <g fill="none" stroke="#fff" stroke-width="1">
      <path
        d="M8.5 18.396V15.5h-2a1 1 0 0 1-1-1v-7a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H12l-3.073 3.073a.25.25 0 0 1-.427-.177Z" />
      <path stroke-linecap="round" d="M8.5 12.5h7m-7-3h7" />
    </g>
  </svg>
</button>

<div id="messageModal"
  class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 max-sm:px-[20px]">
  <div id="modalContent"
    class="transform transition-all duration-300 opacity-0 scale-95 bg-white rounded-lg shadow-lg p-6 max-w-lg  border-2 border-[#8bc83f]">
    <h2 class="text-sm font-bold mb-4">Submit this form to help us
      understand your property needs. The details you provide will help us
      suggest properties in your preferred location. All information is kept
      confidential and will not be shared or misused.</h2>
   
     <form method="POST" action="">
        {% csrf_token %}
      <input type="text" placeholder="Your Name" name="name"
        class="w-full px-3 py-2 border rounded mb-3 focus:outline-none focus:ring" required />
      <input type="text" placeholder="Way to contact you" name="contact"
        class="w-full px-3 py-2 border rounded mb-3 focus:outline-none focus:ring" required />
      <input type="text" placeholder="Your PIN Code" name="pin_code"
        class="w-full px-3 py-2 border rounded mb-3 focus:outline-none focus:ring" required />
      <textarea placeholder="your need or requirements" name="messages_text"
        class="w-full px-3 py-2 border rounded mb-3 focus:outline-none focus:ring" required></textarea>
      <div class="flex justify-end gap-2">
        <button type="button" onclick="closeMessageModal()"
          class="px-4 py-1 bg-gray-300 rounded hover:bg-gray-400 text-sm">Cancel</button>
        <button type="submit" class="px-4 py-1 bg-[#8bc83f] text-white rounded  text-sm">Send</button>
      </div>
    </form>
  </div>
</div>




{% endblock %}




<script>
  // Ensure form submission goes through Web3Forms
  document
    .getElementById("contact-form")
    .addEventListener("submit", function (event) {
      event.preventDefault(); // Prevent the default form submission

      const formData = new FormData(this);

      fetch(this.action, {
        method: this.method,
        body: formData,
      })
        .then((response) => response.json())
        .then((data) => {
          if (data.success) {
            alert("Form submitted successfully!");
            this.reset(); // Reset form after successful submission
          } else {
            alert("There was an issue with your submission. Please try again.");
          }
        })
        .catch((error) => {
          console.error("Error:", error);
          alert("An error occurred. Please try again.");
        });
    });
</script>

<script>
  // Reset form on page load
  window.onload = function () {
    document.querySelector("form").reset(); // Reset the form when the page loads
  };

  // Reset the form after submission
  function resetForm() {
    setTimeout(function () {
      document.querySelector("form").reset(); // Reset the form
    }, 500); // Add a short delay to allow the submission to be processed
  }
</script>


<script>
  // Get the modal
</script>





<script>
  document.addEventListener("DOMContentLoaded", function () {
    const popup = document.querySelector('.popup-message.success');
    if (popup) {
      setTimeout(() => {
        popup.style.display = 'none';
      }, 5000); // Hide popup after 5 seconds
    }
  });
</script>